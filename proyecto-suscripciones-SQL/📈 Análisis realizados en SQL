üìà An√°lisis realizados en SQL

1Ô∏è. Tasa de Churn por plan
SELECT
  plan,
  COUNTIF(is_active = FALSE) AS cancelados,
  COUNT(*) AS total_clientes,
  ROUND(COUNTIF(is_active = FALSE)*100.0/COUNT(*),2) AS churn_rate
FROM subscriptions;
GROUP BY plan
ORDER BY churn_rate

2Ô∏è. Ingresos por tipo de plan
SELECT
  plan,
  SUM(monthly_fee * tenure_months) AS ingresos_por_plan
FROM subscriptions
GROUP BY plan
ORDER BY ingresos_por_plan DESC;

3Ô∏è. Ingresos mensuales
SELECT
  DATE_TRUNC(signup_date, MONTH) AS mes,
  SUM(monthly_fee * tenure_months) AS ingresos
FROM subscriptions
GROUP BY mes
ORDER BY ingresos;

4. Porcentaje de cancelaci√≥n por ciudad
SELECT
  city,
  COUNTIF(is_active = FALSE) AS cancelados,
  COUNT(*) AS total_clientes,
  ROUND(
    COUNTIF(is_active = FALSE) * 100.0 / COUNT(*),
  2) AS churn_percentage
FROM subscriptions
GROUP BY city
ORDER BY churn_percentage DESC;
