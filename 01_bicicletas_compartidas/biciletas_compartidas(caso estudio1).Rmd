---
title: "An√°lisis del comportamiento de usuarios en un sistema de bicicletas compartidas"
author: "Brian Murillo"
date: "2026-01-30"
output:
  html_document: null
  pdf_document: default
---

```{r setup}
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE)

library(dplyr)
library(ggplot2)
library(lubridate)
library(readr)
library(stringr)
```

## Introducci√≥n

Este informe se realizo con el objetivo de analizar el comportamiento entre los miembros cusuales y los miembros anuales del sistema de bicicletas compartidas, con la finalidad de identificar estrategias u oportunidades que ayuden con el crecimiento en la conversi√≥n de usuarios ocasionales a miembros anuales.


### Preguntas Orientadoras

¬øC√≥mo difiere la duraci√≥n de los viajes entre usuarios?

¬øEn qu√© d√≠as y meses se presenta mayor uso?

¬øQu√© patrones explican la baja conversi√≥n?


## Fuente y preparaci√≥n de los datos

Se utilizaron 12 archivos correspondientes a un a√±o completo de viajes, espec√≠ficamente del a√±o 2025. Estos datos fueron consolidados en un √∫nico conjunto de datos (dataset). Posteriormente, se realiz√≥ un proceso de limpieza de datos, en el cual se eliminaron valores nulos, duraciones negativas y viajes con una duraci√≥n superior a 24 horas, ya que estos se consideran registros an√≥malos (ROOC) y no representan un comportamiento real de los usuarios.

## Carga y limpieza de datos

# Cargar todos los archivos

```{r carga_limpieza}
# 1. Cargar archivos
archivos <- list.files("Datos", full.names = TRUE)

if (length(archivos) == 0) {
  stop("‚ùå No se encontraron archivos en la carpeta 'data'")
}

rides_all <- archivos %>%
  lapply(read_csv) %>%
  bind_rows() %>%
  rename_with(tolower)

# 2. Mostrar columnas reales (IMPORTANTE)
cat("üìå Columnas detectadas en el dataset:\n")
print(names(rides_all))

# 3. Buscar columnas de fecha/hora (robusto)
start_col <- names(rides_all)[
  str_detect(names(rides_all), "start|begin")
][1]

end_col <- names(rides_all)[
  str_detect(names(rides_all), "end|stop|finish")
][1]

# 4. Validaci√≥n fuerte
if (is.na(start_col) || is.na(end_col)) {
  stop("‚ùå No se encontraron columnas de inicio o fin.
üëâ Revisa arriba los nombres impresos y ajusta los patrones.")
}

cat("‚úÖ Columna inicio:", start_col, "\n")
cat("‚úÖ Columna fin:", end_col, "\n")

# 5. Renombrar
rides_all <- rides_all %>%
  rename(
    started_at = all_of(start_col),
    ended_at   = all_of(end_col)
  )

# 6. Limpieza y variables nuevas
datos_limpios <- rides_all %>%
  mutate(
    started_at = as.POSIXct(started_at, tz = "UTC"),
    ended_at   = as.POSIXct(ended_at, tz = "UTC"),
    ride_length_min = as.numeric(difftime(ended_at, started_at, units = "mins"))
  ) %>%
  filter(
    !is.na(ride_length_min),
    ride_length_min > 0,
    ride_length_min <= 1440
  ) %>%
  mutate(
    day_of_week = wday(started_at, label = TRUE),
    month = month(started_at, label = TRUE)
  )

cat("‚úÖ Datos limpios:", nrow(datos_limpios), "registros\n")

```

## An√°lisis exploratorio

El analisis que se realizo con base a los datos suministrados por el  sistema de bicicletas compartidas. En esta etapa se realizaron las siguientes acciones:

1. Se calculo la duraci√≥n de cada viaje en minutos, a partir de la diferencia entre la fecha y hora de inicio del recorrido (started_at) y la fehca y hora de finalizaci√≥n del recorrido (ended_At). Esta medida permitio identificar el tiempo de uso del servicio por cada uno de los usuarios.

```{r resumen_usuarios}
datos_limpios %>%
  group_by(member_casual) %>%
  summarise(
    duracion_promedio = mean(ride_length_min),
    duracion_mediana  = median(ride_length_min),
    total_viajes      = n(),
    .groups = "drop"
  )
```

2. Se genero 2 nuevas medidas para facilitar el analisis de estos datos:

###Day_of_week

-day_of_week, que es para identificar el dia de la semana que el usuario utilizo el sistema

```{r grafico_dias}
datos_limpios %>%
  group_by(member_casual, day_of_week) %>%
  summarise(
    duracion_promedio = mean(ride_length_min),
    .groups = "drop"
  ) %>%
  ggplot(aes(day_of_week, duracion_promedio, fill = member_casual)) +
  geom_col(position = "dodge") +
  labs(
    title = "Duraci√≥n promedio del viaje por d√≠a",
    x = "D√≠a de la semana",
    y = "Minutos",
    fill = "Tipo de usuario"
  )
```

**Interpretaci√≥n**

Se puede evidenciar que los usuarios ocasioanels presentan viajes mucho m√°s largos que los miembros; lo que supone que los usuarios ocasionales utilizan el sistema para uso recreativo.

### Uso por mes

-month, para identificar el mes correspondiente al uso del sistema.

```{r graficos_mes}
datos_limpios %>%
  group_by(member_casual, month) %>%
  summarise(
    total_viajes = n(),
    .groups = "drop"
  ) %>%
  ggplot(aes(month, total_viajes, fill = member_casual)) +
  geom_col(position = "dodge") +
  labs(
    title = "Cantidad de viajes por mes",
    x = "Mes",
    y = "N√∫mero de viajes",
    fill = "Tipo de usuario"
  )
```


**Interpretaci√≥n**  
Se observa un aumento significativo de usuarios casuales durante los meses de verano, especialmente en junio.

## Conclusi√≥n
Con base en estos hallazgos, se concluye que la baja conversi√≥n de usuarios ocasionales a miembros anuales no se debe a una falta de inter√©s en el servicio, sino a que el modelo actual de membres√≠a no se adapta a su comportamiento de uso. Por lo tanto, se recomienda implementar membres√≠as flexibles de corta duraci√≥n, como planes mensuales, semestrales o estacionales, as√≠ como promociones espec√≠ficas durante los meses de mayor uso, con el objetivo de incrementar la conversi√≥n y maximizar los ingresos de la empresa.

